#!/usr/bin/env zsh

# Get macOS software updates, update Homebrew, npm, Ruby packages, dotfiles and some other software

function header() {
  echo -e "$(tput sgr 0 1)$(tput setaf 6)$1$(tput sgr0)"
}

# Ask for the administrator password upfront
sudo -v
echo

# Dotfiles
header "Updating dotfiles..."
pushd "$HOME/.dotfiles"
git pull
./sync.py
source "$HOME/.zshrc"
popd
echo

# macOS
header "Updating macOS..."
sudo -v
sudo softwareupdate --all --install --force
echo

# Homebrew
header "Updating Homebrew..."
sudo -v
brew upgrade
brew cleanup
brew doctor
echo

# npm
header "Updating npm..."
npm-check -gsy
echo

# npm
header "Updating Composer..."
composer global self-update
composer global update
echo

# git-friendly
header "Updating git-friendly..."
sudo -v
sudo bash < <(curl https://raw.githubusercontent.com/jamiew/git-friendly/master/install.sh)
echo
